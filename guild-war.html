<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guild War - SuperDuolingo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.2/echarts.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Inter:wght@400;500;600&family=Fredoka+One:wght@400&display=swap" rel="stylesheet">
    <style>
        :root {
            --forest-green: #2D5016;
            --emerald-green: #50C878;
            --mint-green: #98FB98;
            --lime-green: #32CD32;
            --golden-yellow: #FFD700;
            --deep-blue: #1E3A8A;
            --warm-orange: #FF8C00;
            --purple: #8B5CF6;
            --charcoal: #2D3748;
            --light-gray: #F7FAFC;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--mint-green) 0%, var(--light-gray) 100%);
            min-height: 100vh;
        }
        
        .gaming-font {
            font-family: 'Fredoka One', cursive;
        }
        
        .primary-font {
            font-family: 'Nunito', sans-serif;
        }
        
        .war-arena {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border-radius: 20px;
            padding: 32px;
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        .war-arena::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(80, 200, 120, 0.1), transparent);
            animation: rotate 20s linear infinite;
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .guild-banner {
            background: linear-gradient(135deg, var(--emerald-green), var(--lime-green));
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            position: relative;
            z-index: 10;
        }
        
        .enemy-banner {
            background: linear-gradient(135deg, #dc3545, #c82333);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            position: relative;
            z-index: 10;
        }
        
        .war-progress {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            height: 24px;
            margin: 16px 0;
            overflow: hidden;
            position: relative;
            z-index: 10;
        }
        
        .war-progress-bar {
            height: 100%;
            border-radius: 12px;
            transition: width 0.5s ease;
            position: relative;
            z-index: 1;
        }
        
        .guild-progress {
            background: linear-gradient(90deg, var(--emerald-green), var(--lime-green));
        }
        
        .enemy-progress {
            background: linear-gradient(90deg, #dc3545, #c82333);
        }
        
        .battle-action {
            background: linear-gradient(135deg, var(--golden-yellow), var(--warm-orange));
            color: var(--charcoal);
            border: none;
            border-radius: 12px;
            padding: 16px 24px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            margin: 8px;
        }
        
        .battle-action:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 24px rgba(255, 215, 0, 0.4);
        }
        
        .battle-action:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .war-log {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 16px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        .war-log-entry {
            padding: 8px 12px;
            margin-bottom: 8px;
            border-radius: 8px;
            font-size: 0.9rem;
        }
        
        .war-log-entry.guild {
            background: rgba(80, 200, 120, 0.2);
            border-left: 4px solid var(--emerald-green);
        }
        
        .war-log-entry.enemy {
            background: rgba(220, 53, 69, 0.2);
            border-left: 4px solid #dc3545;
        }
        
        .war-log-entry.system {
            background: rgba(255, 215, 0, 0.2);
            border-left: 4px solid var(--golden-yellow);
            text-align: center;
            font-weight: bold;
        }
        
        .member-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--mint-green);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            border: 3px solid var(--emerald-green);
            margin: 4px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .member-avatar:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(80, 200, 120, 0.4);
        }
        
        .member-avatar.attacking {
            animation: pulse-attack 1s infinite;
        }
        
        @keyframes pulse-attack {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); box-shadow: 0 0 20px rgba(255, 215, 0, 0.8); }
        }
        
        .war-timer {
            background: var(--charcoal);
            color: var(--golden-yellow);
            padding: 16px;
            border-radius: 12px;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        .floating-animation {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .pulse-glow {
            animation: pulse-glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes pulse-glow {
            from { box-shadow: 0 0 20px rgba(80, 200, 120, 0.3); }
            to { box-shadow: 0 0 30px rgba(80, 200, 120, 0.6); }
        }
        
        .nav-link {
            transition: all 0.3s ease;
            position: relative;
        }
        
        .nav-link:hover {
            color: var(--emerald-green);
            transform: translateY(-2px);
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--emerald-green);
            transition: width 0.3s ease;
        }
        
        .nav-link:hover::after {
            width: 100%;
        }
        
        .gaming-button {
            background: linear-gradient(135deg, var(--emerald-green), var(--lime-green));
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px 24px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .gaming-button:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 24px rgba(80, 200, 120, 0.4);
        }
        
        .gaming-button.secondary {
            background: linear-gradient(135deg, var(--deep-blue), var(--purple));
        }
        
        .gaming-button.danger {
            background: linear-gradient(135deg, #dc3545, #c82333);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="bg-white/90 backdrop-blur-md shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-4">
                    <img src="resources/mascot.png" alt="SuperDuolingo Mascot" class="h-12 w-12 floating-animation">
                    <h1 class="gaming-font text-2xl text-forest-green">SuperDuolingo</h1>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="index.html" class="nav-link primary-font font-semibold text-charcoal">Home</a>
                    <a href="lessons.html" class="nav-link primary-font font-semibold text-charcoal">Lessons</a>
                    <a href="progress.html" class="nav-link primary-font font-semibold text-charcoal">Progress</a>
                    <a href="profile.html" class="nav-link primary-font font-semibold text-charcoal">Profile</a>
                    <a href="guilds.html" class="nav-link primary-font font-semibold text-charcoal">Guilds</a>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-2">
                        <span class="text-xl">‚öîÔ∏è</span>
                        <span class="primary-font font-bold text-warm-orange">War</span>
                    </div>
                    <button class="gaming-button" onclick="window.location.href='index.html'">
                        Back to Dashboard
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <div class="max-w-7xl mx-auto p-4 py-8">
        <!-- War Header -->
        <div class="text-center mb-8">
            <h2 class="gaming-font text-4xl text-charcoal mb-4">üî• Guild War in Progress! üî•</h2>
            <p class="primary-font text-xl text-gray-600">Polyglot Warriors vs Language Masters</p>
            <div class="war-timer mt-4">
                <div class="text-2xl">‚è∞ Time Remaining: <span id="war-timer">02:14:35</span></div>
            </div>
        </div>

        <!-- War Arena -->
        <div class="war-arena mb-8">
            <div class="relative z-10">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <!-- Your Guild -->
                    <div class="guild-banner">
                        <div class="text-4xl mb-2">üè∞</div>
                        <h3 class="gaming-font text-2xl mb-2">Polyglot Warriors</h3>
                        <div class="text-3xl font-bold">1,247 XP</div>
                        <div class="text-sm opacity-80">Your Guild</div>
                    </div>
                    
                    <!-- Enemy Guild -->
                    <div class="enemy-banner">
                        <div class="text-4xl mb-2">üèõÔ∏è</div>
                        <h3 class="gaming-font text-2xl mb-2">Language Masters</h3>
                        <div class="text-3xl font-bold">987 XP</div>
                        <div class="text-sm opacity-80">Enemy Guild</div>
                    </div>
                </div>
                
                <!-- War Progress -->
                <div class="mb-6">
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-semibold">War Progress</span>
                        <span class="font-bold text-golden-yellow">Winning by 260 XP!</span>
                    </div>
                    
                    <div class="war-progress">
                        <div class="war-progress-bar guild-progress" style="width: 55.8%"></div>
                        <div class="war-progress-bar enemy-progress" style="width: 44.2%; position: absolute; top: 0; right: 0;"></div>
                    </div>
                    
                    <div class="flex justify-between text-sm mt-2">
                        <span>55.8%</span>
                        <span>44.2%</span>
                    </div>
                </div>
                
                <!-- Battle Actions -->
                <div class="text-center mb-6">
                    <h3 class="gaming-font text-xl mb-4">Choose Your Battle Action:</h3>
                    <div class="flex flex-wrap justify-center">
                        <button class="battle-action" onclick="performAction('lesson')">
                            üìö Complete Lesson (+15 XP)
                        </button>
                        <button class="battle-action" onclick="performAction('speaking')">
                            üó£Ô∏è Speaking Practice (+20 XP)
                        </button>
                        <button class="battle-action" onclick="performAction('listening')">
                            üëÇ Listening Exercise (+18 XP)
                        </button>
                        <button class="battle-action" onclick="performAction('grammar')">
                            ‚úçÔ∏è Grammar Quest (+25 XP)
                        </button>
                        <button class="battle-action" onclick="performAction('streak')">
                            üî• Maintain Streak (+30 XP)
                        </button>
                        <button class="battle-action" onclick="performAction('perfect')">
                            üéØ Perfect Score (+50 XP)
                        </button>
                    </div>
                </div>
                
                <!-- Guild Members in Battle -->
                <div class="mb-6">
                    <h3 class="gaming-font text-xl mb-4 text-center">Guild Members in Battle</h3>
                    <div class="flex flex-wrap justify-center">
                        <div class="member-avatar attacking" title="You - Attacking!">‚öîÔ∏è</div>
                        <div class="member-avatar" title="Maria - Ready">üó£Ô∏è</div>
                        <div class="member-avatar" title="Carlos - Ready">üßô‚Äç‚ôÇÔ∏è</div>
                        <div class="member-avatar" title="Ana - Ready">üó∫Ô∏è</div>
                        <div class="member-avatar" title="Diego - Ready">üìö</div>
                        <div class="member-avatar" title="+42 more">+42</div>
                    </div>
                </div>
                
                <!-- War Log -->
                <div class="war-log">
                    <h4 class="gaming-font text-lg mb-4 text-center">‚öîÔ∏è Battle Log ‚öîÔ∏è</h4>
                    <div id="war-log-entries">
                        <div class="war-log-entry system">
                            üîî Guild War has begun! Fight for glory!
                        </div>
                        <div class="war-log-entry guild">
                            ‚öîÔ∏è You completed "Basic Greetings" lesson! +15 XP
                        </div>
                        <div class="war-log-entry enemy">
                            üìö Enemy member completed "Numbers 1-10" +12 XP
                        </div>
                        <div class="war-log-entry guild">
                            üó£Ô∏è Maria completed speaking practice! +20 XP
                        </div>
                        <div class="war-log-entry guild">
                            üéØ Carlos got perfect score in grammar! +50 XP
                        </div>
                        <div class="war-log-entry enemy">
                            üî• Enemy member maintained 7-day streak! +25 XP
                        </div>
                        <div class="war-log-entry system">
                            ‚ö° War intensity increasing! Double XP for next 10 minutes!
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- War Statistics -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <!-- Your Guild Stats -->
            <div class="bg-white rounded-2xl p-6 shadow-lg">
                <h3 class="gaming-font text-2xl text-charcoal mb-4">Your Guild Performance</h3>
                <div class="space-y-4">
                    <div class="flex justify-between items-center">
                        <span>Your Contributions</span>
                        <span class="font-bold text-emerald-green">85 XP</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span>Guild Total</span>
                        <span class="font-bold text-emerald-green">1,247 XP</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span>Rank in Guild</span>
                        <span class="font-bold text-deep-blue">#3</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span>Attacks Made</span>
                        <span class="font-bold text-purple">12</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span>Accuracy</span>
                        <span class="font-bold text-warm-orange">92%</span>
                    </div>
                </div>
            </div>
            
            <!-- War Chart -->
            <div class="bg-white rounded-2xl p-6 shadow-lg">
                <h3 class="gaming-font text-2xl text-charcoal mb-4">War Progress Chart</h3>
                <div id="war-chart" style="height: 300px;"></div>
            </div>
        </div>

        <!-- War Rewards Preview -->
        <div class="bg-white rounded-2xl p-6 shadow-lg mb-8">
            <h3 class="gaming-font text-2xl text-charcoal mb-4">War Rewards Preview</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="text-center p-4 bg-mint-green rounded-lg">
                    <div class="text-3xl mb-2">üèÜ</div>
                    <h4 class="font-bold text-charcoal">Victory</h4>
                    <p class="text-sm text-gray-600">500 XP + Guild Trophy</p>
                </div>
                <div class="text-center p-4 bg-blue-50 rounded-lg">
                    <div class="text-3xl mb-2">ü•à</div>
                    <h4 class="font-bold text-charcoal">Close Match</h4>
                    <p class="text-sm text-gray-600">300 XP + Silver Badge</p>
                </div>
                <div class="text-center p-4 bg-red-50 rounded-lg">
                    <div class="text-3xl mb-2">üíî</div>
                    <h4 class="font-bold text-charcoal">Defeat</h4>
                    <p class="text-sm text-gray-600">100 XP + Participation Medal</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        class GuildWarManager {
            constructor() {
                this.guildScore = 1247;
                this.enemyScore = 987;
                this.yourContributions = 85;
                this.attacksMade = 12;
                this.warLog = [];
                this.timeRemaining = 8055; // 2:14:35 in seconds
                
                this.init();
            }
            
            init() {
                this.setupChart();
                this.startTimer();
                this.startPeriodicUpdates();
                this.animateElements();
            }
            
            setupChart() {
                const chart = echarts.init(document.getElementById('war-chart'));
                const option = {
                    tooltip: {
                        trigger: 'axis'
                    },
                    legend: {
                        data: ['Polyglot Warriors', 'Language Masters']
                    },
                    xAxis: {
                        type: 'category',
                        data: ['Start', '30min', '1h', '1.5h', '2h', 'Now']
                    },
                    yAxis: {
                        type: 'value',
                        name: 'XP'
                    },
                    series: [
                        {
                            name: 'Polyglot Warriors',
                            type: 'line',
                            data: [0, 180, 420, 680, 980, 1247],
                            lineStyle: { color: '#50C878' },
                            itemStyle: { color: '#50C878' },
                            areaStyle: {
                                color: {
                                    type: 'linear',
                                    x: 0, y: 0, x2: 0, y2: 1,
                                    colorStops: [
                                        { offset: 0, color: 'rgba(80, 200, 120, 0.3)' },
                                        { offset: 1, color: 'rgba(80, 200, 120, 0.1)' }
                                    ]
                                }
                            }
                        },
                        {
                            name: 'Language Masters',
                            type: 'line',
                            data: [0, 150, 350, 580, 850, 987],
                            lineStyle: { color: '#dc3545' },
                            itemStyle: { color: '#dc3545' },
                            areaStyle: {
                                color: {
                                    type: 'linear',
                                    x: 0, y: 0, x2: 0, y2: 1,
                                    colorStops: [
                                        { offset: 0, color: 'rgba(220, 53, 69, 0.3)' },
                                        { offset: 1, color: 'rgba(220, 53, 69, 0.1)' }
                                    ]
                                }
                            }
                        }
                    ]
                };
                
                chart.setOption(option);
                
                // Make chart responsive
                window.addEventListener('resize', () => {
                    chart.resize();
                });
            }
            
            startTimer() {
                setInterval(() => {
                    this.timeRemaining--;
                    const hours = Math.floor(this.timeRemaining / 3600);
                    const minutes = Math.floor((this.timeRemaining % 3600) / 60);
                    const seconds = this.timeRemaining % 60;
                    
                    document.getElementById('war-timer').textContent = 
                        `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    
                    if (this.timeRemaining <= 0) {
                        this.endWar();
                    }
                }, 1000);
            }
            
            performAction(action) {
                let xpGain = 0;
                let actionText = '';
                
                switch(action) {
                    case 'lesson':
                        xpGain = 15;
                        actionText = 'completed "Basic Greetings" lesson';
                        break;
                    case 'speaking':
                        xpGain = 20;
                        actionText = 'completed speaking practice';
                        break;
                    case 'listening':
                        xpGain = 18;
                        actionText = 'completed listening exercise';
                        break;
                    case 'grammar':
                        xpGain = 25;
                        actionText = 'completed grammar quest';
                        break;
                    case 'streak':
                        xpGain = 30;
                        actionText = 'maintained daily streak';
                        break;
                    case 'perfect':
                        xpGain = 50;
                        actionText = 'got perfect score';
                        break;
                }
                
                // Add XP to your guild
                this.guildScore += xpGain;
                this.yourContributions += xpGain;
                this.attacksMade++;
                
                // Update UI
                this.updateScores();
                this.addWarLogEntry('guild', `You ${actionText}! +${xpGain} XP`);
                
                // Show celebration
                this.showActionCelebration(xpGain);
                
                // Simulate enemy response
                setTimeout(() => {
                    this.simulateEnemyAction();
                }, 1000 + Math.random() * 3000);
            }
            
            simulateEnemyAction() {
                const actions = [
                    { text: 'completed vocabulary lesson', xp: 12 },
                    { text: 'got perfect score in grammar', xp: 25 },
                    { text: 'maintained 7-day streak', xp: 20 },
                    { text: 'completed listening exercise', xp: 15 },
                    { text: 'mastered 20 new words', xp: 18 }
                ];
                
                const action = actions[Math.floor(Math.random() * actions.length)];
                this.enemyScore += action.xp;
                
                this.updateScores();
                this.addWarLogEntry('enemy', `Enemy member ${action.text}! +${action.xp} XP`);
            }
            
            updateScores() {
                // Update guild scores
                document.querySelector('.guild-banner .text-3xl').textContent = `${this.guildScore} XP`;
                document.querySelector('.enemy-banner .text-3xl').textContent = `${this.enemyScore} XP`;
                
                // Update progress bars
                const total = this.guildScore + this.enemyScore;
                const guildPercent = (this.guildScore / total) * 100;
                const enemyPercent = (this.enemyScore / total) * 100;
                
                document.querySelector('.guild-progress').style.width = `${guildPercent}%`;
                document.querySelector('.enemy-progress').style.width = `${enemyPercent}%`;
                
                // Update percentages
                document.querySelector('.war-progress').parentElement.querySelector('.flex.justify-between span:first-child').textContent = `${guildPercent.toFixed(1)}%`;
                document.querySelector('.war-progress').parentElement.querySelector('.flex.justify-between span:last-child').textContent = `${enemyPercent.toFixed(1)}%`;
                
                // Update war status
                const difference = this.guildScore - this.enemyScore;
                const statusElement = document.querySelector('.text-golden-yellow');
                if (difference > 0) {
                    statusElement.textContent = `üéñÔ∏è Winning by ${difference} XP!`;
                } else if (difference < 0) {
                    statusElement.textContent = `üò∞ Losing by ${Math.abs(difference)} XP!`;
                } else {
                    statusElement.textContent = `‚ö° Tied! Keep fighting!`;
                }
                
                // Update personal stats
                const stats = document.querySelectorAll('.bg-white.rounded-2xl.shadow-lg .space-y-4 .flex.justify-between span:last-child');
                stats[0].textContent = `${this.yourContributions} XP`;
                stats[1].textContent = `${this.guildScore} XP`;
                stats[3].textContent = `${this.attacksMade}`;
            }
            
            addWarLogEntry(type, message) {
                const logContainer = document.getElementById('war-log-entries');
                const entry = document.createElement('div');
                entry.className = `war-log-entry ${type}`;
                entry.textContent = message;
                
                logContainer.appendChild(entry);
                logContainer.scrollTop = logContainer.scrollHeight;
                
                // Animate new entry
                anime({
                    targets: entry,
                    opacity: [0, 1],
                    translateY: [20, 0],
                    duration: 300,
                    easing: 'easeOutQuad'
                });
                
                // Keep only last 10 entries
                const entries = logContainer.querySelectorAll('.war-log-entry');
                if (entries.length > 10) {
                    logContainer.removeChild(entries[0]);
                }
            }
            
            showActionCelebration(xp) {
                // Create celebration particles
                for (let i = 0; i < 20; i++) {
                    const particle = document.createElement('div');
                    particle.style.cssText = `
                        position: fixed;
                        width: 8px;
                        height: 8px;
                        background: ${['#50C878', '#32CD32', '#FFD700'][Math.floor(Math.random() * 3)]};
                        border-radius: 50%;
                        pointer-events: none;
                        z-index: 1000;
                        left: 50%;
                        top: 50%;
                    `;
                    document.body.appendChild(particle);
                    
                    anime({
                        targets: particle,
                        translateX: (Math.random() - 0.5) * 200,
                        translateY: (Math.random() - 0.5) * 200,
                        scale: [1, 0],
                        opacity: [1, 0],
                        duration: 1000,
                        easing: 'easeOutQuad',
                        complete: () => {
                            document.body.removeChild(particle);
                        }
                    });
                }
                
                // Show XP gain
                const xpDisplay = document.createElement('div');
                xpDisplay.textContent = `+${xp} XP`;
                xpDisplay.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    color: var(--golden-yellow);
                    font-size: 2rem;
                    font-weight: bold;
                    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
                    z-index: 1001;
                    pointer-events: none;
                `;
                document.body.appendChild(xpDisplay);
                
                anime({
                    targets: xpDisplay,
                    translateY: [-20, -100],
                    opacity: [1, 0],
                    scale: [1, 1.5],
                    duration: 1500,
                    easing: 'easeOutQuad',
                    complete: () => {
                        document.body.removeChild(xpDisplay);
                    }
                });
            }
            
            startPeriodicUpdates() {
                // Add random war events
                setInterval(() => {
                    if (Math.random() < 0.3) {
                        const events = [
                            'üî• War intensity increasing! Double XP for next 5 minutes!',
                            '‚ö° Special challenge available! Complete for bonus XP!',
                            'üéØ Accuracy bonus active! Perfect scores worth +10 XP!',
                            'üåü Guild morale boost! All attacks +5 XP!',
                            'üíé Rare opportunity! Complete 3 lessons for 100 XP bonus!'
                        ];
                        
                        const event = events[Math.floor(Math.random() * events.length)];
                        this.addWarLogEntry('system', event);
                    }
                }, 15000);
                
                // Update member avatars
                setInterval(() => {
                    const avatars = document.querySelectorAll('.member-avatar');
                    avatars.forEach(avatar => {
                        if (Math.random() < 0.1) {
                            avatar.classList.add('attacking');
                            setTimeout(() => {
                                avatar.classList.remove('attacking');
                            }, 2000);
                        }
                    });
                }, 5000);
            }
            
            endWar() {
                const winner = this.guildScore > this.enemyScore ? 'Polyglot Warriors' : 'Language Masters';
                const message = `üèÜ Guild War has ended! ${winner} wins! üèÜ`;
                
                this.addWarLogEntry('system', message);
                
                // Show final celebration
                setTimeout(() => {
                    window.location.href = 'guilds.html';
                }, 3000);
            }
            
            animateElements() {
                // Animate war arena
                anime({
                    targets: '.war-arena',
                    scale: [0.9, 1],
                    opacity: [0, 1],
                    duration: 1000,
                    easing: 'easeOutBack'
                });
                
                // Animate guild banners
                anime({
                    targets: '.guild-banner, .enemy-banner',
                    translateY: [50, 0],
                    opacity: [0, 1],
                    delay: anime.stagger(200),
                    duration: 800,
                    easing: 'easeOutExpo'
                });
                
                // Animate battle actions
                anime({
                    targets: '.battle-action',
                    scale: [0, 1],
                    opacity: [0, 1],
                    delay: anime.stagger(100),
                    duration: 600,
                    easing: 'easeOutBack'
                });
                
                // Animate member avatars
                anime({
                    targets: '.member-avatar',
                    scale: [0, 1],
                    delay: anime.stagger(50),
                    duration: 500,
                    easing: 'easeOutBack'
                });
            }
        }
        
        // Global functions
        function performAction(action) {
            window.guildWarManager.performAction(action);
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            window.guildWarManager = new GuildWarManager();
        });
    </script>
</body>
</html>